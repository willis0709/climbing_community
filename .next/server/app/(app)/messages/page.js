(()=>{var e={};e.id=164,e.ids=[164],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11492:(e,t,r)=>{Promise.resolve().then(r.bind(r,53588))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},35265:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(82614).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},53588:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/climbing_community/src/app/(app)/messages/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/climbing_community/src/app/(app)/messages/page.tsx","default")},54119:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var a=r(65239),n=r(48088),s=r(88170),l=r.n(s),o=r(30893),i={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);r.d(t,i);let d={children:["",{children:["(app)",{children:["messages",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,53588)),"/home/user/climbing_community/src/app/(app)/messages/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,70718)),"/home/user/climbing_community/src/app/(app)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/home/user/climbing_community/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/home/user/climbing_community/src/app/(app)/messages/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/(app)/messages/page",pathname:"/messages",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},62095:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ev});var a=r(60687),n=r(43210),s=r(89667),l=r(29523),o=r(32584),i=r(14163),d=r(46059),c=r(11273),u=r(98599),p=r(13495),m=r(43),f=r(66156),h=r(67969),x=r(70569),v="ScrollArea",[g,w]=(0,c.A)(v),[b,j]=g(v),y=n.forwardRef((e,t)=>{let{__scopeScrollArea:r,type:s="hover",dir:l,scrollHideDelay:o=600,...d}=e,[c,p]=n.useState(null),[f,h]=n.useState(null),[x,v]=n.useState(null),[g,w]=n.useState(null),[j,y]=n.useState(null),[N,S]=n.useState(0),[C,E]=n.useState(0),[P,R]=n.useState(!1),[T,A]=n.useState(!1),_=(0,u.s)(t,e=>p(e)),L=(0,m.jH)(l);return(0,a.jsx)(b,{scope:r,type:s,dir:L,scrollHideDelay:o,scrollArea:c,viewport:f,onViewportChange:h,content:x,onContentChange:v,scrollbarX:g,onScrollbarXChange:w,scrollbarXEnabled:P,onScrollbarXEnabledChange:R,scrollbarY:j,onScrollbarYChange:y,scrollbarYEnabled:T,onScrollbarYEnabledChange:A,onCornerWidthChange:S,onCornerHeightChange:E,children:(0,a.jsx)(i.sG.div,{dir:L,...d,ref:_,style:{position:"relative","--radix-scroll-area-corner-width":N+"px","--radix-scroll-area-corner-height":C+"px",...e.style}})})});y.displayName=v;var N="ScrollAreaViewport",S=n.forwardRef((e,t)=>{let{__scopeScrollArea:r,children:s,nonce:l,...o}=e,d=j(N,r),c=n.useRef(null),p=(0,u.s)(t,c,d.onViewportChange);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:l}),(0,a.jsx)(i.sG.div,{"data-radix-scroll-area-viewport":"",...o,ref:p,style:{overflowX:d.scrollbarXEnabled?"scroll":"hidden",overflowY:d.scrollbarYEnabled?"scroll":"hidden",...e.style},children:(0,a.jsx)("div",{ref:d.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});S.displayName=N;var C="ScrollAreaScrollbar",E=n.forwardRef((e,t)=>{let{forceMount:r,...s}=e,l=j(C,e.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:i}=l,d="horizontal"===e.orientation;return n.useEffect(()=>(d?o(!0):i(!0),()=>{d?o(!1):i(!1)}),[d,o,i]),"hover"===l.type?(0,a.jsx)(P,{...s,ref:t,forceMount:r}):"scroll"===l.type?(0,a.jsx)(R,{...s,ref:t,forceMount:r}):"auto"===l.type?(0,a.jsx)(T,{...s,ref:t,forceMount:r}):"always"===l.type?(0,a.jsx)(A,{...s,ref:t}):null});E.displayName=C;var P=n.forwardRef((e,t)=>{let{forceMount:r,...s}=e,l=j(C,e.__scopeScrollArea),[o,i]=n.useState(!1);return n.useEffect(()=>{let e=l.scrollArea,t=0;if(e){let r=()=>{window.clearTimeout(t),i(!0)},a=()=>{t=window.setTimeout(()=>i(!1),l.scrollHideDelay)};return e.addEventListener("pointerenter",r),e.addEventListener("pointerleave",a),()=>{window.clearTimeout(t),e.removeEventListener("pointerenter",r),e.removeEventListener("pointerleave",a)}}},[l.scrollArea,l.scrollHideDelay]),(0,a.jsx)(d.C,{present:r||o,children:(0,a.jsx)(T,{"data-state":o?"visible":"hidden",...s,ref:t})})}),R=n.forwardRef((e,t)=>{var r,s;let{forceMount:l,...o}=e,i=j(C,e.__scopeScrollArea),c="horizontal"===e.orientation,u=V(()=>m("SCROLL_END"),100),[p,m]=(r="hidden",s={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},n.useReducer((e,t)=>s[e][t]??e,r));return n.useEffect(()=>{if("idle"===p){let e=window.setTimeout(()=>m("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(e)}},[p,i.scrollHideDelay,m]),n.useEffect(()=>{let e=i.viewport,t=c?"scrollLeft":"scrollTop";if(e){let r=e[t],a=()=>{let a=e[t];r!==a&&(m("SCROLL"),u()),r=a};return e.addEventListener("scroll",a),()=>e.removeEventListener("scroll",a)}},[i.viewport,c,m,u]),(0,a.jsx)(d.C,{present:l||"hidden"!==p,children:(0,a.jsx)(A,{"data-state":"hidden"===p?"hidden":"visible",...o,ref:t,onPointerEnter:(0,x.m)(e.onPointerEnter,()=>m("POINTER_ENTER")),onPointerLeave:(0,x.m)(e.onPointerLeave,()=>m("POINTER_LEAVE"))})})}),T=n.forwardRef((e,t)=>{let r=j(C,e.__scopeScrollArea),{forceMount:s,...l}=e,[o,i]=n.useState(!1),c="horizontal"===e.orientation,u=V(()=>{if(r.viewport){let e=r.viewport.offsetWidth<r.viewport.scrollWidth,t=r.viewport.offsetHeight<r.viewport.scrollHeight;i(c?e:t)}},10);return B(r.viewport,u),B(r.content,u),(0,a.jsx)(d.C,{present:s||o,children:(0,a.jsx)(A,{"data-state":o?"visible":"hidden",...l,ref:t})})}),A=n.forwardRef((e,t)=>{let{orientation:r="vertical",...s}=e,l=j(C,e.__scopeScrollArea),o=n.useRef(null),i=n.useRef(0),[d,c]=n.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=Y(d.viewport,d.content),p={...s,sizes:d,onSizesChange:c,hasThumb:!!(u>0&&u<1),onThumbChange:e=>o.current=e,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:e=>i.current=e};function m(e,t){return function(e,t,r,a="ltr"){let n=G(r),s=t||n/2,l=r.scrollbar.paddingStart+s,o=r.scrollbar.size-r.scrollbar.paddingEnd-(n-s),i=r.content-r.viewport;return F([l,o],"ltr"===a?[0,i]:[-1*i,0])(e)}(e,i.current,d,t)}return"horizontal"===r?(0,a.jsx)(_,{...p,ref:t,onThumbPositionChange:()=>{if(l.viewport&&o.current){let e=X(l.viewport.scrollLeft,d,l.dir);o.current.style.transform=`translate3d(${e}px, 0, 0)`}},onWheelScroll:e=>{l.viewport&&(l.viewport.scrollLeft=e)},onDragScroll:e=>{l.viewport&&(l.viewport.scrollLeft=m(e,l.dir))}}):"vertical"===r?(0,a.jsx)(L,{...p,ref:t,onThumbPositionChange:()=>{if(l.viewport&&o.current){let e=X(l.viewport.scrollTop,d);o.current.style.transform=`translate3d(0, ${e}px, 0)`}},onWheelScroll:e=>{l.viewport&&(l.viewport.scrollTop=e)},onDragScroll:e=>{l.viewport&&(l.viewport.scrollTop=m(e))}}):null}),_=n.forwardRef((e,t)=>{let{sizes:r,onSizesChange:s,...l}=e,o=j(C,e.__scopeScrollArea),[i,d]=n.useState(),c=n.useRef(null),p=(0,u.s)(t,c,o.onScrollbarXChange);return n.useEffect(()=>{c.current&&d(getComputedStyle(c.current))},[c]),(0,a.jsx)(z,{"data-orientation":"horizontal",...l,ref:p,sizes:r,style:{bottom:0,left:"rtl"===o.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===o.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":G(r)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.x),onDragScroll:t=>e.onDragScroll(t.x),onWheelScroll:(t,r)=>{if(o.viewport){let a=o.viewport.scrollLeft+t.deltaX;e.onWheelScroll(a),function(e,t){return e>0&&e<t}(a,r)&&t.preventDefault()}},onResize:()=>{c.current&&o.viewport&&i&&s({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:q(i.paddingLeft),paddingEnd:q(i.paddingRight)}})}})}),L=n.forwardRef((e,t)=>{let{sizes:r,onSizesChange:s,...l}=e,o=j(C,e.__scopeScrollArea),[i,d]=n.useState(),c=n.useRef(null),p=(0,u.s)(t,c,o.onScrollbarYChange);return n.useEffect(()=>{c.current&&d(getComputedStyle(c.current))},[c]),(0,a.jsx)(z,{"data-orientation":"vertical",...l,ref:p,sizes:r,style:{top:0,right:"ltr"===o.dir?0:void 0,left:"rtl"===o.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":G(r)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.y),onDragScroll:t=>e.onDragScroll(t.y),onWheelScroll:(t,r)=>{if(o.viewport){let a=o.viewport.scrollTop+t.deltaY;e.onWheelScroll(a),function(e,t){return e>0&&e<t}(a,r)&&t.preventDefault()}},onResize:()=>{c.current&&o.viewport&&i&&s({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:q(i.paddingTop),paddingEnd:q(i.paddingBottom)}})}})}),[D,k]=g(C),z=n.forwardRef((e,t)=>{let{__scopeScrollArea:r,sizes:s,hasThumb:l,onThumbChange:o,onThumbPointerUp:d,onThumbPointerDown:c,onThumbPositionChange:m,onDragScroll:f,onWheelScroll:h,onResize:v,...g}=e,w=j(C,r),[b,y]=n.useState(null),N=(0,u.s)(t,e=>y(e)),S=n.useRef(null),E=n.useRef(""),P=w.viewport,R=s.content-s.viewport,T=(0,p.c)(h),A=(0,p.c)(m),_=V(v,10);function L(e){S.current&&f({x:e.clientX-S.current.left,y:e.clientY-S.current.top})}return n.useEffect(()=>{let e=e=>{let t=e.target;b?.contains(t)&&T(e,R)};return document.addEventListener("wheel",e,{passive:!1}),()=>document.removeEventListener("wheel",e,{passive:!1})},[P,b,R,T]),n.useEffect(A,[s,A]),B(b,_),B(w.content,_),(0,a.jsx)(D,{scope:r,scrollbar:b,hasThumb:l,onThumbChange:(0,p.c)(o),onThumbPointerUp:(0,p.c)(d),onThumbPositionChange:A,onThumbPointerDown:(0,p.c)(c),children:(0,a.jsx)(i.sG.div,{...g,ref:N,style:{position:"absolute",...g.style},onPointerDown:(0,x.m)(e.onPointerDown,e=>{0===e.button&&(e.target.setPointerCapture(e.pointerId),S.current=b.getBoundingClientRect(),E.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",w.viewport&&(w.viewport.style.scrollBehavior="auto"),L(e))}),onPointerMove:(0,x.m)(e.onPointerMove,L),onPointerUp:(0,x.m)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),document.body.style.webkitUserSelect=E.current,w.viewport&&(w.viewport.style.scrollBehavior=""),S.current=null})})})}),U="ScrollAreaThumb",I=n.forwardRef((e,t)=>{let{forceMount:r,...n}=e,s=k(U,e.__scopeScrollArea);return(0,a.jsx)(d.C,{present:r||s.hasThumb,children:(0,a.jsx)(M,{ref:t,...n})})}),M=n.forwardRef((e,t)=>{let{__scopeScrollArea:r,style:s,...l}=e,o=j(U,r),d=k(U,r),{onThumbPositionChange:c}=d,p=(0,u.s)(t,e=>d.onThumbChange(e)),m=n.useRef(void 0),f=V(()=>{m.current&&(m.current(),m.current=void 0)},100);return n.useEffect(()=>{let e=o.viewport;if(e){let t=()=>{f(),m.current||(m.current=$(e,c),c())};return c(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}},[o.viewport,f,c]),(0,a.jsx)(i.sG.div,{"data-state":d.hasThumb?"visible":"hidden",...l,ref:p,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:(0,x.m)(e.onPointerDownCapture,e=>{let t=e.target.getBoundingClientRect(),r=e.clientX-t.left,a=e.clientY-t.top;d.onThumbPointerDown({x:r,y:a})}),onPointerUp:(0,x.m)(e.onPointerUp,d.onThumbPointerUp)})});I.displayName=U;var H="ScrollAreaCorner",O=n.forwardRef((e,t)=>{let r=j(H,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return"scroll"!==r.type&&n?(0,a.jsx)(W,{...e,ref:t}):null});O.displayName=H;var W=n.forwardRef((e,t)=>{let{__scopeScrollArea:r,...s}=e,l=j(H,r),[o,d]=n.useState(0),[c,u]=n.useState(0),p=!!(o&&c);return B(l.scrollbarX,()=>{let e=l.scrollbarX?.offsetHeight||0;l.onCornerHeightChange(e),u(e)}),B(l.scrollbarY,()=>{let e=l.scrollbarY?.offsetWidth||0;l.onCornerWidthChange(e),d(e)}),p?(0,a.jsx)(i.sG.div,{...s,ref:t,style:{width:o,height:c,position:"absolute",right:"ltr"===l.dir?0:void 0,left:"rtl"===l.dir?0:void 0,bottom:0,...e.style}}):null});function q(e){return e?parseInt(e,10):0}function Y(e,t){let r=e/t;return isNaN(r)?0:r}function G(e){let t=Y(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd;return Math.max((e.scrollbar.size-r)*t,18)}function X(e,t,r="ltr"){let a=G(t),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=t.scrollbar.size-n,l=t.content-t.viewport,o=(0,h.q)(e,"ltr"===r?[0,l]:[-1*l,0]);return F([0,l],[0,s-a])(o)}function F(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let a=(t[1]-t[0])/(e[1]-e[0]);return t[0]+a*(r-e[0])}}var $=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},a=0;return!function n(){let s={left:e.scrollLeft,top:e.scrollTop},l=r.left!==s.left,o=r.top!==s.top;(l||o)&&t(),r=s,a=window.requestAnimationFrame(n)}(),()=>window.cancelAnimationFrame(a)};function V(e,t){let r=(0,p.c)(e),a=n.useRef(0);return n.useEffect(()=>()=>window.clearTimeout(a.current),[]),n.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(r,t)},[r,t])}function B(e,t){let r=(0,p.c)(t);(0,f.N)(()=>{let t=0;if(e){let a=new ResizeObserver(()=>{cancelAnimationFrame(t),t=window.requestAnimationFrame(r)});return a.observe(e),()=>{window.cancelAnimationFrame(t),a.unobserve(e)}}},[e,r])}var J=r(4780);let K=n.forwardRef(({className:e,children:t,...r},n)=>(0,a.jsxs)(y,{ref:n,className:(0,J.cn)("relative overflow-hidden",e),...r,children:[(0,a.jsx)(S,{className:"h-full w-full rounded-[inherit]",children:t}),(0,a.jsx)(Z,{}),(0,a.jsx)(O,{})]}));K.displayName=y.displayName;let Z=n.forwardRef(({className:e,orientation:t="vertical",...r},n)=>(0,a.jsx)(E,{ref:n,orientation:t,className:(0,J.cn)("flex touch-none select-none transition-colors","vertical"===t&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:(0,a.jsx)(I,{className:"relative flex-1 rounded-full bg-border"})}));Z.displayName=E.displayName;var Q=r(96834),ee=r(71133);function et({conversation:e,isSelected:t,onSelect:r,currentUserId:n}){let s=e.participants.find(e=>e.id!==n)||e.participants[0]||{name:"Unknown",avatarUrl:""},l=e.lastMessage?.text||"No messages yet.",i=e.lastMessage?.timestamp?(0,ee.m)(new Date(e.lastMessage.timestamp),{addSuffix:!0}):"";return(0,a.jsxs)("button",{onClick:r,className:(0,J.cn)("flex w-full items-center gap-3 p-3 text-left hover:bg-muted/50 rounded-lg transition-colors",t&&"bg-muted"),children:[(0,a.jsxs)(o.Avatar,{className:"h-10 w-10 border",children:[(0,a.jsx)(o.AvatarImage,{src:s.avatarUrl,alt:s.name,"data-ai-hint":"person avatar"}),(0,a.jsx)(o.AvatarFallback,{children:s.name.substring(0,1).toUpperCase()})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm truncate",children:e.title||s.name}),i&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground whitespace-nowrap",children:i})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:l}),e.unreadCount&&e.unreadCount>0&&(0,a.jsx)(Q.E,{variant:"default",className:"h-5 px-2 text-xs",children:e.unreadCount})]})]})]})}var er=r(18329),ea=r(41936),en=r(35265),es=r(85866),el=r(36464),eo=r(74627),ei=r(26134),ed=r(78726);let ec=ei.bL;ei.l9;let eu=ei.ZL;ei.bm;let ep=n.forwardRef(({className:e,...t},r)=>(0,a.jsx)(ei.hJ,{ref:r,className:(0,J.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));ep.displayName=ei.hJ.displayName;let em=n.forwardRef(({className:e,children:t,...r},n)=>(0,a.jsxs)(eu,{children:[(0,a.jsx)(ep,{}),(0,a.jsxs)(ei.UC,{ref:n,className:(0,J.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,(0,a.jsxs)(ei.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(ed.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));em.displayName=ei.UC.displayName;let ef=({className:e,...t})=>(0,a.jsx)("div",{className:(0,J.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});ef.displayName="DialogHeader";let eh=n.forwardRef(({className:e,...t},r)=>(0,a.jsx)(ei.hE,{ref:r,className:(0,J.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));eh.displayName=ei.hE.displayName;let ex=n.forwardRef(({className:e,...t},r)=>(0,a.jsx)(ei.VY,{ref:r,className:(0,J.cn)("text-sm text-muted-foreground",e),...t}));function ev(){let[e,t]=(0,n.useState)(null),[r,i]=(0,n.useState)([]),[d,c]=(0,n.useState)(null),[u,p]=(0,n.useState)([]),[m,f]=(0,n.useState)(""),[h,x]=(0,n.useState)(""),[v,g]=(0,n.useState)(!1),w=e=>{c(e),i(r.map(t=>t.id===e.id?{...t,unreadCount:0}:t))},b=r.filter(t=>(t.title||t.participants.find(t=>t.id!==e?.id)?.name||"Conversation").toLowerCase().includes(h.toLowerCase())),j=t=>{if(!e)return;let a=r.find(r=>2===r.participants.length&&r.participants.some(t=>t.id===e.id)&&r.participants.some(e=>e.id===t.id));if(a)c(a);else{let r={id:`conv-${Date.now()}`,participants:[{id:e.id,name:e.name,avatarUrl:e.avatarUrl},{id:t.id,name:t.name,avatarUrl:t.avatarUrl}],lastMessage:void 0,unreadCount:0,title:t.name};r.id in el.cL||(el.cL[r.id]=[]),i(e=>[r,...e].sort((e,t)=>new Date(t.lastMessage?.timestamp||0).getTime()-new Date(e.lastMessage?.timestamp||0).getTime())),c(r)}g(!1)};return e?(0,a.jsxs)("div",{className:"flex h-[calc(100vh-4rem)] border-t",children:[(0,a.jsxs)("div",{className:"w-1/3 border-r flex flex-col bg-muted/20",children:[(0,a.jsxs)("div",{className:"p-4 border-b",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold flex items-center",children:[(0,a.jsx)(er.A,{className:"mr-2 h-6 w-6 text-primary"})," Messages"]}),(0,a.jsxs)("div",{className:"relative mt-2",children:[(0,a.jsx)(ea.A,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(s.p,{placeholder:"Search conversations...",className:"pl-8",value:h,onChange:e=>x(e.target.value)})]}),(0,a.jsxs)(l.$,{variant:"outline",size:"sm",onClick:()=>g(!0),className:"mt-3 w-full",children:[(0,a.jsx)(en.A,{className:"mr-2 h-4 w-4"}),"New Message"]})]}),(0,a.jsx)(K,{className:"flex-1 p-2 space-y-1",children:b.length>0?b.map(t=>(0,a.jsx)(et,{conversation:t,isSelected:d?.id===t.id,onSelect:()=>w(t),currentUserId:e.id},t.id)):(0,a.jsx)("p",{className:"p-4 text-sm text-muted-foreground text-center",children:"No conversations found."})})]}),(0,a.jsx)("div",{className:"w-2/3 flex flex-col bg-background",children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-4 border-b flex items-center gap-3",children:[(0,a.jsxs)(o.Avatar,{className:"h-10 w-10 border",children:[(0,a.jsx)(o.AvatarImage,{src:d.participants.find(t=>t.id!==e.id)?.avatarUrl,alt:d.title}),(0,a.jsx)(o.AvatarFallback,{children:d.title?.substring(0,1).toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold",children:d.title||d.participants.find(t=>t.id!==e.id)?.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Online (mock status)"})]})]}),(0,a.jsx)(K,{className:"flex-1 p-4 space-y-4",children:u.map(t=>(0,a.jsx)("div",{className:`flex ${t.senderId===e.id?"justify-end":"justify-start"}`,children:(0,a.jsxs)("div",{className:`max-w-xs lg:max-w-md p-3 rounded-lg shadow ${t.senderId===e.id?"bg-primary text-primary-foreground":"bg-muted"}`,children:[(0,a.jsx)("p",{className:"text-sm",children:t.text}),(0,a.jsx)("p",{className:`text-xs mt-1 ${t.senderId===e.id?"text-primary-foreground/70 text-right":"text-muted-foreground/70 text-left"}`,children:(0,eo.GP)(new Date(t.timestamp),"p")})]})},t.id))}),(0,a.jsx)("form",{onSubmit:t=>{if(t.preventDefault(),!m.trim()||!d||!e)return;let a={id:`msg-${Date.now()}`,conversationId:d.id,senderId:e.id,text:m,timestamp:new Date().toISOString(),read:!0};p(e=>[...e,a]),i(r.map(e=>e.id===d.id?{...e,lastMessage:a}:e).sort((e,t)=>new Date(t.lastMessage?.timestamp||0).getTime()-new Date(e.lastMessage?.timestamp||0).getTime())),f("")},className:"p-4 border-t bg-muted/50",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(s.p,{value:m,onChange:e=>f(e.target.value),placeholder:"Type your message...",className:"flex-1",autoComplete:"off"}),(0,a.jsxs)(l.$,{type:"submit",size:"icon",disabled:!m.trim(),children:[(0,a.jsx)(es.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"sr-only",children:"Send"})]})]})})]}):(0,a.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-muted-foreground",children:[(0,a.jsx)(er.A,{className:"h-16 w-16 mb-4"}),(0,a.jsx)("p",{className:"text-lg",children:"Select a conversation to start chatting"}),(0,a.jsx)("p",{className:"text-sm",children:"or search for existing conversations, or start a new one."})]})}),(0,a.jsx)(ec,{open:v,onOpenChange:g,children:(0,a.jsxs)(em,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(ef,{children:[(0,a.jsx)(eh,{children:"Start a new conversation"}),(0,a.jsx)(ex,{children:"Select a user to start chatting with."})]}),(0,a.jsxs)(K,{className:"max-h-[calc(100vh-20rem)] sm:max-h-[300px] mt-4 pr-3",children:[" ",(0,a.jsx)("div",{className:"space-y-1",children:el.rB.filter(t=>t.id!==e?.id).map(e=>(0,a.jsxs)(l.$,{variant:"ghost",className:"w-full justify-start gap-3 p-2 h-auto",onClick:()=>j(e),children:[(0,a.jsxs)(o.Avatar,{className:"h-9 w-9 border",children:[(0,a.jsx)(o.AvatarImage,{src:e.avatarUrl,alt:e.name,"data-ai-hint":"person avatar"}),(0,a.jsx)(o.AvatarFallback,{children:e.name.substring(0,1)})]}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.climbingExperience," Climber"]})]})]},e.id))})]})]})})]}):(0,a.jsx)("div",{className:"p-4",children:"Loading user..."})}ex.displayName=ei.VY.displayName},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67969:(e,t,r)=>{"use strict";function a(e,[t,r]){return Math.min(r,Math.max(t,e))}r.d(t,{q:()=>a})},79551:e=>{"use strict";e.exports=require("url")},85866:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(82614).A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},92932:(e,t,r)=>{Promise.resolve().then(r.bind(r,62095))}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[447,454,21,297,133,627,725],()=>r(54119));module.exports=a})();