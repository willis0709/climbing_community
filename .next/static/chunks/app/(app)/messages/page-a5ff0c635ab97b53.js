(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2164],{1394:(e,t,a)=>{"use strict";a.d(t,{Avatar:()=>i,AvatarFallback:()=>o,AvatarImage:()=>d});var s=a(5155),r=a(2115),l=a(5977),n=a(9434);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.bL,{ref:t,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...r})});i.displayName=l.bL.displayName;let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l._V,{ref:t,className:(0,n.cn)("aspect-square h-full w-full",a),...r})});d.displayName=l._V.displayName;let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.H4,{ref:t,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...r})});o.displayName=l.H4.displayName},1580:(e,t,a)=>{Promise.resolve().then(a.bind(a,9755))},2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var s=a(5155),r=a(2115),l=a(9434);let n=r.forwardRef((e,t)=>{let{className:a,type:r,...n}=e;return(0,s.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});n.displayName="Input"},6126:(e,t,a)=>{"use strict";a.d(t,{E:()=>i});var s=a(5155);a(2115);var r=a(2085),l=a(9434);let n=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,l.cn)(n({variant:a}),t),...r})}},9755:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});var s=a(5155),r=a(2115),l=a(2523),n=a(285),i=a(1394),d=a(7655),o=a(9434);let c=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(d.bL,{ref:t,className:(0,o.cn)("relative overflow-hidden",a),...l,children:[(0,s.jsx)(d.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,s.jsx)(m,{}),(0,s.jsx)(d.OK,{})]})});c.displayName=d.bL.displayName;let m=r.forwardRef((e,t)=>{let{className:a,orientation:r="vertical",...l}=e;return(0,s.jsx)(d.VM,{ref:t,orientation:r,className:(0,o.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...l,children:(0,s.jsx)(d.lr,{className:"relative flex-1 rounded-full bg-border"})})});m.displayName=d.VM.displayName;var u=a(6126),x=a(7263);function f(e){var t,a;let{conversation:r,isSelected:l,onSelect:n,currentUserId:d}=e,c=r.participants.find(e=>e.id!==d)||r.participants[0]||{name:"Unknown",avatarUrl:""},m=(null==(t=r.lastMessage)?void 0:t.text)||"No messages yet.",f=(null==(a=r.lastMessage)?void 0:a.timestamp)?(0,x.m)(new Date(r.lastMessage.timestamp),{addSuffix:!0}):"";return(0,s.jsxs)("button",{onClick:n,className:(0,o.cn)("flex w-full items-center gap-3 p-3 text-left hover:bg-muted/50 rounded-lg transition-colors",l&&"bg-muted"),children:[(0,s.jsxs)(i.Avatar,{className:"h-10 w-10 border",children:[(0,s.jsx)(i.AvatarImage,{src:c.avatarUrl,alt:c.name,"data-ai-hint":"person avatar"}),(0,s.jsx)(i.AvatarFallback,{children:c.name.substring(0,1).toUpperCase()})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"font-semibold text-sm truncate",children:r.title||c.name}),f&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground whitespace-nowrap",children:f})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:m}),r.unreadCount&&r.unreadCount>0&&(0,s.jsx)(u.E,{variant:"default",className:"h-5 px-2 text-xs",children:r.unreadCount})]})]})]})}var p=a(4063),h=a(5074),g=a(4301),v=a(3672),N=a(9022),j=a(7426),b=a(5452),w=a(5318);let y=b.bL;b.l9;let C=b.ZL;b.bm;let k=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(b.hJ,{ref:t,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});k.displayName=b.hJ.displayName;let A=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(C,{children:[(0,s.jsx)(k,{}),(0,s.jsxs)(b.UC,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[r,(0,s.jsxs)(b.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(w.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});A.displayName=b.UC.displayName;let S=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};S.displayName="DialogHeader";let M=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(b.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});M.displayName=b.hE.displayName;let U=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(b.VY,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...r})});function I(){var e,t,a;let[d,o]=(0,r.useState)(null),[m,u]=(0,r.useState)([]),[x,b]=(0,r.useState)(null),[w,C]=(0,r.useState)([]),[k,I]=(0,r.useState)(""),[L,D]=(0,r.useState)(""),[E,R]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=N.rB[0];o(e),e&&u((0,N.VX)(e.id))},[]),(0,r.useEffect)(()=>{x?C((0,N.vP)(x.id)):C([])},[x]);let V=e=>{b(e),u(m.map(t=>t.id===e.id?{...t,unreadCount:0}:t))},_=m.filter(e=>{var t;return(e.title||(null==(t=e.participants.find(e=>e.id!==(null==d?void 0:d.id)))?void 0:t.name)||"Conversation").toLowerCase().includes(L.toLowerCase())}),z=e=>{if(!d)return;let t=m.find(t=>2===t.participants.length&&t.participants.some(e=>e.id===d.id)&&t.participants.some(t=>t.id===e.id));if(t)b(t);else{let t={id:"conv-".concat(Date.now()),participants:[{id:d.id,name:d.name,avatarUrl:d.avatarUrl},{id:e.id,name:e.name,avatarUrl:e.avatarUrl}],lastMessage:void 0,unreadCount:0,title:e.name};t.id in N.cL||(N.cL[t.id]=[]),u(e=>[t,...e].sort((e,t)=>{var a,s;return new Date((null==(a=t.lastMessage)?void 0:a.timestamp)||0).getTime()-new Date((null==(s=e.lastMessage)?void 0:s.timestamp)||0).getTime()})),b(t)}R(!1)};return d?(0,s.jsxs)("div",{className:"flex h-[calc(100vh-4rem)] border-t",children:[(0,s.jsxs)("div",{className:"w-1/3 border-r flex flex-col bg-muted/20",children:[(0,s.jsxs)("div",{className:"p-4 border-b",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold flex items-center",children:[(0,s.jsx)(p.A,{className:"mr-2 h-6 w-6 text-primary"})," Messages"]}),(0,s.jsxs)("div",{className:"relative mt-2",children:[(0,s.jsx)(h.A,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(l.p,{placeholder:"Search conversations...",className:"pl-8",value:L,onChange:e=>D(e.target.value)})]}),(0,s.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>R(!0),className:"mt-3 w-full",children:[(0,s.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"New Message"]})]}),(0,s.jsx)(c,{className:"flex-1 p-2 space-y-1",children:_.length>0?_.map(e=>(0,s.jsx)(f,{conversation:e,isSelected:(null==x?void 0:x.id)===e.id,onSelect:()=>V(e),currentUserId:d.id},e.id)):(0,s.jsx)("p",{className:"p-4 text-sm text-muted-foreground text-center",children:"No conversations found."})})]}),(0,s.jsx)("div",{className:"w-2/3 flex flex-col bg-background",children:x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"p-4 border-b flex items-center gap-3",children:[(0,s.jsxs)(i.Avatar,{className:"h-10 w-10 border",children:[(0,s.jsx)(i.AvatarImage,{src:null==(e=x.participants.find(e=>e.id!==d.id))?void 0:e.avatarUrl,alt:x.title}),(0,s.jsx)(i.AvatarFallback,{children:null==(t=x.title)?void 0:t.substring(0,1).toUpperCase()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold",children:x.title||(null==(a=x.participants.find(e=>e.id!==d.id))?void 0:a.name)}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Online (mock status)"})]})]}),(0,s.jsx)(c,{className:"flex-1 p-4 space-y-4",children:w.map(e=>(0,s.jsx)("div",{className:"flex ".concat(e.senderId===d.id?"justify-end":"justify-start"),children:(0,s.jsxs)("div",{className:"max-w-xs lg:max-w-md p-3 rounded-lg shadow ".concat(e.senderId===d.id?"bg-primary text-primary-foreground":"bg-muted"),children:[(0,s.jsx)("p",{className:"text-sm",children:e.text}),(0,s.jsx)("p",{className:"text-xs mt-1 ".concat(e.senderId===d.id?"text-primary-foreground/70 text-right":"text-muted-foreground/70 text-left"),children:(0,j.GP)(new Date(e.timestamp),"p")})]})},e.id))}),(0,s.jsx)("form",{onSubmit:e=>{if(e.preventDefault(),!k.trim()||!x||!d)return;let t={id:"msg-".concat(Date.now()),conversationId:x.id,senderId:d.id,text:k,timestamp:new Date().toISOString(),read:!0};C(e=>[...e,t]),u(m.map(e=>e.id===x.id?{...e,lastMessage:t}:e).sort((e,t)=>{var a,s;return new Date((null==(a=t.lastMessage)?void 0:a.timestamp)||0).getTime()-new Date((null==(s=e.lastMessage)?void 0:s.timestamp)||0).getTime()})),I("")},className:"p-4 border-t bg-muted/50",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.p,{value:k,onChange:e=>I(e.target.value),placeholder:"Type your message...",className:"flex-1",autoComplete:"off"}),(0,s.jsxs)(n.$,{type:"submit",size:"icon",disabled:!k.trim(),children:[(0,s.jsx)(v.A,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Send"})]})]})})]}):(0,s.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-muted-foreground",children:[(0,s.jsx)(p.A,{className:"h-16 w-16 mb-4"}),(0,s.jsx)("p",{className:"text-lg",children:"Select a conversation to start chatting"}),(0,s.jsx)("p",{className:"text-sm",children:"or search for existing conversations, or start a new one."})]})}),(0,s.jsx)(y,{open:E,onOpenChange:R,children:(0,s.jsxs)(A,{className:"sm:max-w-[425px]",children:[(0,s.jsxs)(S,{children:[(0,s.jsx)(M,{children:"Start a new conversation"}),(0,s.jsx)(U,{children:"Select a user to start chatting with."})]}),(0,s.jsxs)(c,{className:"max-h-[calc(100vh-20rem)] sm:max-h-[300px] mt-4 pr-3",children:[" ",(0,s.jsx)("div",{className:"space-y-1",children:N.rB.filter(e=>e.id!==(null==d?void 0:d.id)).map(e=>(0,s.jsxs)(n.$,{variant:"ghost",className:"w-full justify-start gap-3 p-2 h-auto",onClick:()=>z(e),children:[(0,s.jsxs)(i.Avatar,{className:"h-9 w-9 border",children:[(0,s.jsx)(i.AvatarImage,{src:e.avatarUrl,alt:e.name,"data-ai-hint":"person avatar"}),(0,s.jsx)(i.AvatarFallback,{children:e.name.substring(0,1)})]}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.climbingExperience," Climber"]})]})]},e.id))})]})]})})]}):(0,s.jsx)("div",{className:"p-4",children:"Loading user..."})}U.displayName=b.VY.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[2848,7576,5756,5431,4042,2125,1394,8441,1684,7358],()=>t(1580)),_N_E=e.O()}]);